# 实现计划

- [x] 1. 设置项目结构和依赖





  - 创建项目目录结构（static、templates 文件夹）
  - 创建 requirements.txt 文件，包含 Flask、openai、python-dotenv 依赖
  - 创建 .env.example 文件作为环境变量配置模板
  - 创建 .gitignore 文件，排除 .env 和 __pycache__
  - _需求: 5.1, 5.2, 5.3_

- [ ] 2. 实现后端 Flask 应用核心
  - [ ] 2.1 创建 Flask 应用基础结构
    - 编写 app.py 文件，初始化 Flask 应用
    - 配置环境变量加载（使用 python-dotenv）
    - 实现主页路由 GET /，返回 HTML 页面
    - _需求: 5.1, 5.3_

  - [ ] 2.2 实现 OpenAI API 集成
    - 编写函数构建推荐提示词，根据用户心情生成合适的 prompt
    - 编写函数调用 OpenAI API，传递心情描述并获取推荐
    - 编写函数解析 API 响应，提取书名、作者和推荐理由
    - 实现错误处理，捕获 API 调用异常
    - _需求: 1.4, 4.1, 4.3_

  - [ ] 2.3 实现推荐 API 端点
    - 创建 POST /api/recommend 路由
    - 实现请求验证，检查 mood 字段是否存在且不为空
    - 调用 OpenAI 集成函数获取推荐结果
    - 返回 JSON 格式的推荐数据或错误信息
    - 设置 30 秒超时处理
    - _需求: 1.3, 1.4, 2.3, 4.1, 4.2, 4.3, 4.4_

- [ ] 3. 实现前端界面
  - [ ] 3.1 创建 HTML 页面结构
    - 创建 templates/index.html 文件
    - 实现页面布局：标题、心情输入区、预设选项、提交按钮
    - 添加推荐结果展示区域
    - 添加加载状态指示器元素
    - 添加错误提示区域
    - _需求: 1.1, 1.2, 3.1, 3.2, 3.3, 3.4, 6.2_

  - [ ] 3.2 实现 CSS 样式
    - 创建 static/style.css 文件
    - 实现响应式布局，适配移动端和桌面端
    - 设计输入表单样式
    - 设计推荐结果卡片样式
    - 设计加载动画效果
    - 设计错误提示样式
    - _需求: 6.1, 6.2, 6.3, 6.4_

  - [ ] 3.3 实现客户端 JavaScript 逻辑
    - 创建 static/script.js 文件
    - 实现表单提交处理函数，阻止默认提交行为
    - 实现客户端输入验证，检查心情输入不为空
    - 实现 AJAX 请求函数，发送 POST 请求到 /api/recommend
    - 实现加载状态显示和隐藏函数
    - 实现推荐结果渲染函数，动态创建推荐卡片
    - 实现错误处理和显示函数
    - 添加预设心情选项的点击事件处理
    - _需求: 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 3.4, 4.1, 4.2, 4.4, 6.3_

- [ ] 4. 配置和文档
  - 创建 README.md 文件，包含项目说明、安装步骤、运行方法
  - 在 .env.example 中添加配置说明和示例值
  - 添加代码注释，说明关键函数和逻辑
  - _需求: 5.4_

- [ ] 5. 集成测试和验证
  - [ ] 5.1 测试完整用户流程
    - 启动 Flask 应用
    - 在浏览器中打开应用
    - 测试输入自定义心情并获取推荐
    - 测试点击预设心情选项并获取推荐
    - 验证推荐结果显示正确（书名、作者、理由）
    - _需求: 1.1, 1.2, 1.3, 1.4, 3.1, 3.2, 3.3, 3.4_

  - [ ] 5.2 测试错误处理
    - 测试空输入提交，验证客户端验证
    - 测试无效 API 密钥，验证错误提示
    - 测试网络错误场景，验证错误显示
    - _需求: 1.3, 4.1, 4.2, 4.3, 4.4_

  - [ ] 5.3 测试响应式设计
    - 在不同屏幕尺寸下测试界面布局
    - 验证移动端和桌面端的显示效果
    - _需求: 6.1, 6.2, 6.4_

- [ ]* 6. 编写单元测试
  - 创建 tests 目录和测试文件
  - 编写 OpenAI API 集成函数的单元测试（使用 mock）
  - 编写提示词构建函数的测试
  - 编写响应解析函数的测试
  - 编写 API 端点的集成测试
  - _需求: 1.4, 4.1_
